"use strict";(self["webpackChunknode_final"]=self["webpackChunknode_final"]||[]).push([[318],{4331:function(e,t,o){var s=o(1120),a=o(3766),n=o(3248),l=o(6294),i=o(2323),r=o(7965);const c=(0,l.Z)(),d=(0,i.Z)();t["Z"]=(0,a.Q_)("userStore",{state:()=>({profile:{name:"",photo:"",gender:"",_id:""},tempProfile:{name:"",photo:"",gender:""},personalInfo:{name:"",photo:"",_id:""}}),actions:{signIn(e,t){c.toggleLoading(!0),(0,n.TV)(t).then((t=>{const{token:o}=t.data.data;(0,r.o4)(o),e.resetForm(),c.toggleLoading(!1),s.Z.push({name:"DynamicWallView"})})).catch((e=>{c.pushMessage({style:"danger",content:e.response?.data?.message||"登入失敗"}),c.toggleLoading(!1)}))},signUp(e,t){c.toggleLoading(!0),(0,n.pY)(t).then((t=>{const{token:o}=t.data.data;(0,r.o4)(o),e.resetForm(),c.pushMessage({style:"dark",content:"註冊成功"}),c.toggleLoading(!1),s.Z.push({name:"DynamicWallView"})})).catch((e=>{c.pushMessage({style:"danger",content:e.response?.data?.message||"註冊失敗"}),c.toggleLoading(!1)}))},async getProfile(){c.isLoading=!0,await(0,n.TY)().then((e=>{this.profile=e.data.data,this.updateProfileData(this.profile),c.isLoading=!1})).catch((e=>{c.pushMessage({style:"danger",content:e.response?.data?.message||"取得個人資料失敗，請重新登入"}),c.isLoading=!1,(0,r.qz)(),s.Z.push("/signin")}))},async updateProfile(e){c.toggleLoading(!0),await(0,n.MH)(e).then((e=>{this.profile=e.data.data.user,this.updateProfileData(this.profile),d.toggleMsgModal({title:"更新個人資料",content:"已成功更新您的個人資料~"}),c.toggleLoading(!1)})).catch((e=>{c.pushMessage({style:"danger",content:e.response?.data?.message||"更新失敗"}),c.toggleLoading(!1)}))},async updatePassword(e,t){c.toggleLoading(!0),await(0,n.HS)(t).then((()=>{e.resetForm(),d.toggleMsgModal({title:"更新密碼成功",content:"下次登入記得使用新密碼喔~"}),c.toggleLoading(!1)})).catch((e=>{c.pushMessage({style:"danger",content:e.response?.data?.message||"更新密碼失敗"}),c.toggleLoading(!1)}))},async sendForgetEmail(e){c.toggleLoading(!0),await(0,n.ZP)(e).then((()=>{d.toggleMsgModal({title:"信件已寄出，請收取郵件",content:"請至信箱收取重設密碼信，若 1 天內沒收到信再請嘗試一次~"}),c.toggleLoading(!1)})).catch((e=>{d.toggleMsgModal({title:"驗證信箱失敗",content:e.response?.data?.message||"驗證信箱失敗，再請確認信箱"}),c.toggleLoading(!1)}))},async modifyPassword(e,t){c.toggleLoading(!0),await(0,n.$F)(e,t).then((()=>{d.toggleMsgModal({title:"重設密碼成功",content:"請使用新密碼登入喔~"}),s.Z.push("/signin"),c.toggleLoading(!1)})).catch((e=>{d.toggleMsgModal({title:"重設密碼失敗",content:e.response?.data?.message||"重設密碼失敗"}),c.toggleLoading(!1)}))},updateProfileData(e){this.tempProfile={name:e.name,photo:e.photo,gender:e.gender}},togglePersonalInfo(e){this.personalInfo=e}}})},9318:function(e,t,o){o.r(t),o.d(t,{default:function(){return re}});var s=o(3396);const a={key:0},n={class:"container pt-11 pb-14 pb-lg-11"},l={class:"row"},i={class:"col-12 col-lg-8"},r={class:"col-lg-4 position-relative"};function c(e,t,o,c,d,g){const p=(0,s.up)("NavbarComponent"),u=(0,s.up)("router-view"),h=(0,s.up)("AsideComponent");return d.checkSuccess?((0,s.wg)(),(0,s.iD)("div",a,[(0,s.Wm)(p,{onSignOut:g.signOut},null,8,["onSignOut"]),(0,s._)("main",n,[(0,s._)("div",l,[(0,s._)("div",i,[((0,s.wg)(),(0,s.j4)(u,{key:e.$route.fullPath}))]),(0,s._)("div",r,[(0,s.Wm)(h)])])])])):(0,s.kq)("",!0)}var d=o(7139),g=o(9242),p=o(2893);const u={class:"navbar"},h={class:"container d-flex justify-content-between align-items-center"},m=(0,s.Uk)("MetaWall"),f={class:"d-flex align-items-center"},b=["src"],w={key:1,src:p,class:"thumbnail thumbnail-sm"},k={class:"dropdown"},v={class:"dropdown-toggle ms-3 px-2 border-bottom border-2 text-dark fw-bolder",href:"#",role:"button",id:"dropdownMenuLink","data-bs-toggle":"dropdown","aria-expanded":"false"},L={class:"dropdown-menu dropdown-menu-end customShadow text-center","aria-labelledby":"dropdownMenuLink"},Z={class:"bg-white border border-2 border-bottom-0"},P={class:"bg-white border border-2 border-bottom-0"},W=(0,s.Uk)("全體動態牆"),y={class:"bg-white border border-2 border-bottom-0"},_=(0,s.Uk)(" 修改個人資料 "),M={class:"bg-white border border-2"};function x(e,t,o,a,n,l){const i=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",u,[(0,s._)("div",h,[(0,s.Wm)(i,{to:"/",class:"navbarBrand"},{default:(0,s.w5)((()=>[m])),_:1}),(0,s._)("div",f,[e.profile.photo?((0,s.wg)(),(0,s.iD)("img",{key:0,src:e.profile.photo,class:"thumbnail thumbnail-sm"},null,8,b)):((0,s.wg)(),(0,s.iD)("img",w)),(0,s._)("div",k,[(0,s._)("a",v,(0,d.zw)(e.profile.name),1),(0,s._)("ul",L,[(0,s._)("li",Z,[(0,s._)("a",{href:"#",onClick:t[0]||(t[0]=(0,g.iM)(((...e)=>l.toPersonalWall&&l.toPersonalWall(...e)),["prevent"])),class:(0,d.C_)(["dropdown-item",{active:"PersonalWallView"===e.$route.name&&"router-link-active"}])}," 我的貼文牆 ",2)]),(0,s._)("li",P,[(0,s.Wm)(i,{to:"/",class:"dropdown-item"},{default:(0,s.w5)((()=>[W])),_:1})]),(0,s._)("li",y,[(0,s.Wm)(i,{to:"/profile",class:"dropdown-item"},{default:(0,s.w5)((()=>[_])),_:1})]),(0,s._)("li",M,[(0,s._)("a",{href:"#",class:"dropdown-item",onClick:t[1]||(t[1]=(0,g.iM)((t=>e.$emit("sign-out")),["prevent"]))}," 登出 ")])])])])])])}var A=o(3766),C=o(4331),q={name:"NavbarComponent",methods:{toPersonalWall(){const e=this.profile._id;this.togglePersonalInfo(this.profile),this.$router.push({path:`/personalwall/${e}`})},...(0,A.nv)(C.Z,["togglePersonalInfo"])},computed:{...(0,A.rn)(C.Z,["profile"])}},S=o(89);const V=(0,S.Z)(q,[["render",x]]);var K=V;const N={class:"aside"},D={class:"asideContent"},H=(0,s.Uk)(" 張貼動態 "),I={class:"asideList"},z={class:"mb-lg-8"},U=["src"],Y={key:1,src:p,class:"thumbnail thumbnail-xl"},G={class:"d-none d-lg-block ms-4 fw-bolder"},R={class:"mb-lg-8"},B=(0,s._)("div",{class:"asideLinkIcon"},[(0,s._)("i",{class:"bi bi-house-door"})],-1),F=(0,s._)("h5",{class:"d-none d-lg-block ms-4 fw-bolder"},"全體動態牆",-1),X={class:"mb-lg-8"},E=(0,s._)("div",{class:"asideLinkIcon"},[(0,s._)("i",{class:"bi bi-bell"})],-1),O=(0,s._)("h5",{class:"d-none d-lg-block ms-4 fw-bolder"},"追蹤名單",-1),j=(0,s._)("div",{class:"asideLinkIcon"},[(0,s._)("i",{class:"bi bi-hand-thumbs-up"})],-1),J=(0,s._)("h5",{class:"d-none d-lg-block ms-4 fw-bolder"},"我按讚的文章",-1),Q={class:"d-lg-none"},T=(0,s._)("div",{class:"asideLinkIcon"},[(0,s._)("i",{class:"bi bi-plus-lg"})],-1);function $(e,t,o,a,n,l){const i=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("aside",N,[(0,s._)("div",D,[(0,s.Wm)(i,{to:"/createpost",class:"effectBtn d-none d-lg-block btn btn-primary w-100 mb-6 fw-bold"},{default:(0,s.w5)((()=>[H])),_:1}),(0,s._)("ul",I,[(0,s._)("li",z,[(0,s._)("a",{href:"#",class:(0,d.C_)(["asideLink",{active:"PersonalWallView"===e.$route.name&&"router-link-active"}]),onClick:t[0]||(t[0]=(0,g.iM)(((...e)=>l.toPersonalWall&&l.toPersonalWall(...e)),["prevent"]))},[e.profile.photo?((0,s.wg)(),(0,s.iD)("img",{key:0,src:e.profile.photo,class:"thumbnail thumbnail-xl"},null,8,U)):((0,s.wg)(),(0,s.iD)("img",Y)),(0,s._)("h5",G,(0,d.zw)(e.profile.name)+" 的貼文牆 ",1)],2)]),(0,s._)("li",R,[(0,s.Wm)(i,{to:"/",class:"asideLink"},{default:(0,s.w5)((()=>[B,F])),_:1})]),(0,s._)("li",X,[(0,s.Wm)(i,{to:"/follow",class:"asideLink"},{default:(0,s.w5)((()=>[E,O])),_:1})]),(0,s._)("li",null,[(0,s.Wm)(i,{to:"/likeposts",class:"asideLink"},{default:(0,s.w5)((()=>[j,J])),_:1})]),(0,s._)("li",Q,[(0,s.Wm)(i,{to:"/createpost",class:"asideLink"},{default:(0,s.w5)((()=>[T])),_:1})])])])])}var ee={name:"AsideComponent",methods:{toPersonalWall(){const e=this.profile._id;this.togglePersonalInfo(this.profile),this.$router.push({path:`/personalwall/${e}`})},...(0,A.nv)(C.Z,["togglePersonalInfo"])},computed:{...(0,A.rn)(C.Z,["profile"])}};const te=(0,S.Z)(ee,[["render",$]]);var oe=te,se=o(6294),ae=o(7965),ne=o(3248),le={name:"LayoutView",data(){return{checkSuccess:!1,preRouteName:""}},methods:{checkSignIn(){const e=(0,ae.LP)();e?(this.checkSuccess=!0,this.$http.defaults.headers.common.Authorization=`Bearer ${e}`,this.getProfile()):(this.checkSuccess=!1,this.pushMessage({style:"danger",content:"請先登入"}),this.$router.push("/signin"))},signOut(){(0,ae.qz)(),this.checkSuccess=!1,this.$router.push("/signin")},...(0,A.nv)(se.Z,["pushMessage"]),...(0,A.nv)(C.Z,["getProfile"])},created(){this.checkSignIn(),ne.Wb.on("connect",(()=>{console.log(`${this.$route.name} socket connected`),this.preRouteName=this.$route.name})),ne.Wb.on("disconnect",(()=>{console.log(`${this.preRouteName} socket disconnect`)}))},components:{NavbarComponent:K,AsideComponent:oe}};const ie=(0,S.Z)(le,[["render",c]]);var re=ie},2893:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGsAAABrCAMAAABHYYw+AAABKVBMVEXd7fpcZnDGxsjf7fve7/tcZXLGxcrEx8fFxcddZnHGxslaZW/HyMnc7vrIyMre6fZcZXDd7/nExsqfoqjIxcjHxsZkbnjd7v3g7/zh7/rU2eVcZm7R4OvGxszFx8mnt8FbZHG+vsKqrLDf7/meqrbX4+p8iJTf7fh7iZTc6/fb6fXU2uPU3eXa5vC9vsJeZ3Ha5fKirrmUm6NjbXfY5O3X4e3C0N6tvMewusaFjZZud39oc37d7PrS2eDG0t7Gxcl1e4VdY29aZWzHyMywvsm2u764ub2Vm6B0fYVhanbg7f3V2t+7xdDCwcWmtL6ytLqBho1faXPi7/zb5/LK1+PIxsy/wsKqqa6PmKCHjZdveINocXrCytK5xs+sq7CXoK2ipqyIi5Z+ipM8r/IdAAAEIUlEQVRo3u3aaVPaUBSA4XtPbm5WkKREoBhqSSkFRVCxC+5rtYvV7vv2/39ED0kKQdNPPcxYm2eGneGdAyEkGVgmk8lkMpnMVVISrCwSnjwpsWkRGw9uTZhT2LSI9rqaZD0rTyVWRtgyeMLel4oiECOiKBsbiqK0H6CHt1ZVnjD/7eHQawWRtCJz57xQUBFPMHiB4zt5StgKKkEwdzLspLJOg6DSpGkFQfvg4LRr8EuqCC/eHxy8xhYJMadiKGqlU+8wKnPzydT0W/y6tZRS6VKrauzxCXeaNK3Lc60PBsZ0WkJMtozuC7DPOS8Y5K3AcS638idTabW3tp5ZfET9tL5+5O1/XP90Pq7zla2tNYLV1H3LKvCx3UPT9nWwa7Vjg49Z88sULV7lI0Zh/hA8CeD57jHn3cS8JC3V4COrsydLvoYt19TPZmfHLYOmxUMq4t0Xz9/Cb8+fv/2oVkexZUbQMsZzdY+KJozld/iopZK0rD0rttc9cmGitTtvxXaXFYf9rb5vukhDNfAgSXM9rRZzFwlaHd98AzK2vQ0pigDe/ib7e519WwMJEdOEFBI8L79A0FJarZ4Psbxt2xCz7XweQmZts9XKEWwDPxFOS4IWwRHRaMa4pelPFUcQtHKKmNFHs0AStiLFBSYEo2qlM8ctNLVW9Ln9wy3U7L3q2+Zo6YtBTN981Wk1GRFRdtrYiumhxDdtUQkEo1IqsbatAzJ1SIruWywp+Awyky0zucxjK+cwSq28DS6AjZn4PG65mrnIaLVwufPSWhqQtzY6nYYbrQ/zWNDzIRvgaaczw4gJpY0t09R1QDpeg/C0qOCqkNEqsRndl74vTakBKnqaNFG0WUgea6yt9fsNKEat4uZaA82UGTmlhD9QQgjH97CFZANvo6nM5eQYapog4xYbyjHC2IXjCY4J0Vxaw2FjOcqWEyvVILamjJDNVQ4qqBx7aWtFE9VqjaASe1kJHJpWUOnfG7v748OHR6Gfd8ceNBkJIa7lcYBr28LPay/aA0vNDHeZqnccqlbv8eOVxyvveZozfGRl5Zmgas24UgN52+ApbsiilP5NRtbaHraW1NSWNlxfLeRot0WX0ucCJBdY1rpiLe32n1roZtbKWlkra/0/LVi6pq3bq7MXrKLvU2ntW5wXLuBWXSdsCeG0dPAA8tyoGlWeUKha1XcSQMJTR2kS7INt9HqN8PCxvXN8fGLxBGOwsxO25Gav3yKYq+f6LoT7kq6Ug4m5dg+xE84F4C8SzNWRbzwoakWcrSgHPMk6Ksqw5boAFEdvtnzP9KSHk22DOyjwhOqhpm/72BpO/ZmRaONc0vN3LYurPEG1LOsrzuVBfZlRqYevZw0Xh4m58FSHoTojbKF6gV/8/4HKq2cwxAjV63XGU0WPkUtvha5c6xe/H4JCWEurNwAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=318.d6805978.js.map