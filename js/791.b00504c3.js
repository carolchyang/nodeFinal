"use strict";(self["webpackChunknode_final"]=self["webpackChunknode_final"]||[]).push([[791],{6059:function(t,e,n){n.d(e,{Z:function(){return k}});var a=n(3396),i=n(7139),o=n(9242);const s={"aria-label":"Page navigation"},l={class:"pagination justify-content-center"},r=(0,a._)("span",{"aria-hidden":"true"},"«",-1),d=[r],g=["onClick"],p=(0,a._)("span",{"aria-hidden":"true"},"»",-1),c=[p];function m(t,e,n,r,p,m){return(0,a.wg)(),(0,a.iD)("nav",s,[(0,a._)("ul",l,[(0,a._)("li",{class:(0,i.C_)(["page-item",{disabled:!(n.pagination.current_pages>1)}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,o.iM)((t=>m.changePage(n.pagination.current_pages-1)),["prevent"]))},d)],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.pagination.total_pages,(t=>((0,a.wg)(),(0,a.iD)("li",{class:(0,i.C_)(["page-item",{active:n.pagination.current_pages==t}]),key:t},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,o.iM)((e=>m.changePage(t)),["prevent"])},(0,i.zw)(t),9,g)],2)))),128)),(0,a._)("li",{class:(0,i.C_)(["page-item",{disabled:!(n.pagination.current_pages<n.pagination.total_pages)}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,o.iM)((t=>m.changePage(n.pagination.current_pages+1)),["prevent"]))},c)],2)])])}var u={name:"PaginationComponent",props:["pagination"],emits:["get-all"],methods:{changePage(t=1){this.$emit("get-all",t,"loading")}}},h=n(89);const _=(0,h.Z)(u,[["render",m]]);var k=_},2248:function(t,e,n){n.r(e),n.d(e,{default:function(){return E}});var a=n(3396),i=n(9242),o=n(7139);const s={class:"row g-3 mb-4"},l={class:"col-12 col-md-4"},r=(0,a._)("option",{value:"1"},"由新到舊",-1),d=(0,a._)("option",{value:"0"},"由舊到新",-1),g=[r,d],p={class:"col-12 col-md-8"},c={class:"input-group input-group-sm"},m=(0,a._)("i",{class:"bi bi-search h3"},null,-1),u=[m],h=(0,a.Uk)("目前尚無動態，新增一則貼文吧！"),_={class:"d-md-inline-block mb-3 mb-md-0"},k=(0,a.Uk)(" 確定要刪除此則 "),C={class:"text-danger"},f=(0,a.Uk)(" ？ "),v=(0,a._)("span",null,"（刪除後無法回復）",-1);function b(t,e,n,r,d,m){const b=(0,a.up)("ArticleComponent"),w=(0,a.up)("EmptyCardComponent"),y=(0,a.up)("PaginationComponent"),L=(0,a.up)("DelModalComponent");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",s,[(0,a._)("div",l,[(0,a.wy)((0,a._)("select",{class:"form-select form-select-sm","onUpdate:modelValue":e[0]||(e[0]=t=>d.reverse=t),onChange:e[1]||(e[1]=t=>m.getAll(1,"loading"))},g,544),[[i.bM,d.reverse]])]),(0,a._)("div",p,[(0,a._)("div",c,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",placeholder:"搜尋貼文","aria-label":"search","aria-describedby":"search","onUpdate:modelValue":e[2]||(e[2]=t=>d.keyword=t)},null,512),[[i.nr,d.keyword,void 0,{trim:!0}]]),(0,a._)("button",{class:"effectBtn btn btn-primary py-0 px-3",type:"button",id:"search",onClick:e[3]||(e[3]=(0,i.iM)((t=>m.getAll(1,"loading")),["prevent"]))},u)])])]),t.posts.length?((0,a.wg)(),(0,a.j4)(b,{key:0,data:t.posts,profile:t.profile,onToggleLike:m.toggleLike,onUpdateComments:m.updateComments},null,8,["data","profile","onToggleLike","onUpdateComments"])):((0,a.wg)(),(0,a.j4)(w,{key:1},{default:(0,a.w5)((()=>[h])),_:1})),t.posts.length?((0,a.wg)(),(0,a.j4)(y,{key:2,pagination:t.pagination,onGetAll:m.getAll},null,8,["pagination","onGetAll"])):(0,a.kq)("",!0),(0,a.Wm)(L,{onDelData:m.delData},{default:(0,a.w5)((()=>[(0,a._)("p",_,[k,(0,a._)("b",C,(0,o.zw)(t.modal.title),1),f]),v])),_:1},8,["onDelData"])],64)}n(6699);var w=n(6511),y=n(7729),L=n(6059),P=n(2312),I=n(3766),Z=n(6294),D=n(2323),A=n(4331),W=n(7484),M=n(6634),U=n(407),x=n(3248),j={name:"DynamicWallView",data(){return{keyword:"",reverse:1}},watch:{postIds(){x.Wb.emit("register",this.postIds)}},methods:{async getAll(t=1,e){e&&this.toggleLoading(!0);const n={};n.page=t,n.reverse=this.reverse,n.content=this.keyword,await this.getPosts(n),this.toggleLoading(!1),x.Wb.emit("register",this.postIds)},async delData(){this.togglePartLoading(this.modal.id,this.modal.type);let t="delComment",e=this.pagination?.current_pages;"delpost"==this.modal.type&&(t="delPost",e=1),await this[t](this.modal.id),await this.getAll(e),this.togglePartLoading("",""),x.Wb.emit("register",this.postIds)},async toggleLike({id:t,type:e}){this.togglePartLoading(t,"like");let n="clickLike";"cancel"==e&&(n="delLike"),await this[n](t),await this.getAll(this.pagination?.current_pages),this.togglePartLoading("","")},async updateComments(t){this.togglePartLoading(t.postId,"comment"),await this.createComment(t),await this.getAll(this.pagination?.current_pages),this.togglePartLoading("","")},...(0,I.nv)(Z.Z,["toggleLoading","togglePartLoading"]),...(0,I.nv)(W.Z,["getPosts","delPost"]),...(0,I.nv)(M.Z,["clickLike","delLike"]),...(0,I.nv)(U.Z,["createComment","delComment"])},computed:{...(0,I.rn)(D.Z,["modal"]),...(0,I.rn)(A.Z,["profile"]),...(0,I.rn)(W.Z,["posts","pagination"]),postIds(){return this.posts.map((t=>t.id))}},components:{ArticleComponent:w.Z,EmptyCardComponent:y.Z,PaginationComponent:L.Z,DelModalComponent:P.Z},created(){this.getAll(1,"loading"),x.Wb.connect(),x.Wb.on("addComment",(t=>{const e=this.posts.find((e=>e._id===t.postId));e.comments.unshift(t)})),x.Wb.on("removeComment",(({postId:t,commentId:e})=>{if(!this.postIds.includes(t))return;const n=this.posts.find((e=>e._id===t)),a=n.comments.findIndex((t=>t._id===e));a>-1&&n.comments.splice(a,1)})),x.Wb.on("updateLikeCount",(({isLike:t,userId:e,postId:n})=>{if(!this.postIds.includes(n))return;const a=this.posts.findIndex((t=>t._id===n)),i=this.posts[a].likeCount;t?i.push(e):i.splice(a,1)}))},unmounted(){x.Wb.disconnect()}},V=n(89);const z=(0,V.Z)(j,[["render",b]]);var E=z}}]);
//# sourceMappingURL=791.b00504c3.js.map