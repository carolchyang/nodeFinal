{"version":3,"file":"js/605.67df15e9.js","mappings":"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","sources":["webpack://node_final/./src/stores/userStore.js","webpack://node_final/./src/components/MsgModalComponent.vue","webpack://node_final/./src/components/MsgModalComponent.vue?431b","webpack://node_final/./src/views/front/ProfileView.vue","webpack://node_final/./src/views/front/ProfileView.vue?5182"],"sourcesContent":["import router from \"@/router\";\nimport { defineStore } from \"pinia\";\nimport {\n  apiUserSignIn,\n  apiUserSignUp,\n  apiGetProfile,\n  apiUpdateProfile,\n  apiUpdatePassword,\n  apiForgetPassword,\n  apiModifyPassword,\n} from \"@/scripts/api\";\nimport statusStore from \"./statusStore\";\nimport modalStore from \"./modalStore\";\nimport { setToken, clearToken } from \"@/scripts/methods\";\n\nconst status = statusStore();\nconst modal = modalStore();\n\nexport default defineStore(\"userStore\", {\n  state: () => {\n    return {\n      // 個人資料\n      profile: {\n        name: \"\",\n        photo: \"\",\n        gender: \"\",\n        _id: \"\",\n      },\n      // 個人資料頁面 - 個人資料暫存表格\n      tempProfile: {\n        name: \"\",\n        photo: \"\",\n        gender: \"\",\n      },\n      //個人牆頁面設置\n      personalInfo: {\n        name: \"\",\n        photo: \"\",\n        _id: \"\",\n      },\n    };\n  },\n  actions: {\n    // 登入\n    signIn(form, data) {\n      status.toggleLoading(true);\n      apiUserSignIn(data)\n        .then((res) => {\n          // 設定 token\n          const { token } = res.data.data;\n          setToken(token);\n\n          // 重置表單\n          form.resetForm();\n\n          status.toggleLoading(false);\n\n          // 轉至全體動態牆頁面\n          router.push({ name: \"DynamicWallView\" });\n        })\n        .catch((err) => {\n          status.pushMessage({\n            style: \"danger\",\n            content: err.response?.data?.message || \"登入失敗\",\n          });\n          status.toggleLoading(false);\n        });\n    },\n    // 註冊\n    signUp(form, data) {\n      status.toggleLoading(true);\n      apiUserSignUp(data)\n        .then((res) => {\n          // 設定 token\n          const { token } = res.data.data;\n          setToken(token);\n\n          // 清空表格\n          form.resetForm();\n\n          status.pushMessage({\n            style: \"dark\",\n            content: \"註冊成功\",\n          });\n\n          status.toggleLoading(false);\n          router.push({ name: \"DynamicWallView\" });\n        })\n        .catch((err) => {\n          status.pushMessage({\n            style: \"danger\",\n            content: err.response?.data?.message || \"註冊失敗\",\n          });\n          status.toggleLoading(false);\n        });\n    },\n    // 取得用戶資料\n    async getProfile() {\n      status.isLoading = true;\n      await apiGetProfile()\n        .then((res) => {\n          this.profile = res.data.data;\n          this.updateProfileData(this.profile);\n\n          status.isLoading = false;\n        })\n        .catch((err) => {\n          status.pushMessage({\n            style: \"danger\",\n            content:\n              err.response?.data?.message || \"取得個人資料失敗，請重新登入\",\n          });\n          status.isLoading = false;\n\n          // 若驗證個人資料失敗則強制登出\n          clearToken();\n          router.push(\"/signin\");\n        });\n    },\n    // 更新個人資料\n    async updateProfile(data) {\n      status.toggleLoading(true);\n      await apiUpdateProfile(data)\n        .then((res) => {\n          this.profile = res.data.data.user;\n\n          // 更新用戶 data 資料\n          this.updateProfileData(this.profile);\n\n          // 開啟 msgModal 提示訊息\n          modal.toggleMsgModal({\n            title: \"更新個人資料\",\n            content: \"已成功更新您的個人資料~\",\n          });\n          status.toggleLoading(false);\n        })\n        .catch((err) => {\n          status.pushMessage({\n            style: \"danger\",\n            content: err.response?.data?.message || \"更新失敗\",\n          });\n          status.toggleLoading(false);\n        });\n    },\n    // 更新密碼\n    async updatePassword(form, data) {\n      status.toggleLoading(true);\n      await apiUpdatePassword(data)\n        .then(() => {\n          // 重置表單\n          form.resetForm();\n\n          // 開啟 msgModal 提示訊息\n          modal.toggleMsgModal({\n            title: \"更新密碼成功\",\n            content: \"下次登入記得使用新密碼喔~\",\n          });\n\n          status.toggleLoading(false);\n        })\n        .catch((err) => {\n          status.pushMessage({\n            style: \"danger\",\n            content: err.response?.data?.message || \"更新密碼失敗\",\n          });\n          status.toggleLoading(false);\n        });\n    },\n    // 寄信重設 Email\n    async sendForgetEmail(data) {\n      status.toggleLoading(true);\n      await apiForgetPassword(data)\n        .then(() => {\n          // 開啟 msgModal 提示訊息\n          modal.toggleMsgModal({\n            title: \"信件已寄出，請收取郵件\",\n            content: \"請至信箱收取重設密碼信，若 1 天內沒收到信再請嘗試一次~\",\n          });\n\n          status.toggleLoading(false);\n        })\n        .catch((err) => {\n          modal.toggleMsgModal({\n            title: \"驗證信箱失敗\",\n            content:\n              err.response?.data?.message || \"驗證信箱失敗，再請確認信箱\",\n          });\n          status.toggleLoading(false);\n        });\n    },\n    // 重設密碼 - 收取郵件\n    async modifyPassword(token, data) {\n      status.toggleLoading(true);\n      await apiModifyPassword(token, data)\n        .then(() => {\n          // 開啟 msgModal 提示訊息\n          modal.toggleMsgModal({\n            title: \"重設密碼成功\",\n            content: \"請使用新密碼登入喔~\",\n          });\n\n          router.push(\"/signin\");\n          status.toggleLoading(false);\n        })\n        .catch((err) => {\n          modal.toggleMsgModal({\n            title: \"重設密碼失敗\",\n            content: err.response?.data?.message || \"重設密碼失敗\",\n          });\n          status.toggleLoading(false);\n        });\n    },\n    // 更新個人資料頁面 - 個人資料暫存表格\n    updateProfileData(data) {\n      this.tempProfile = {\n        name: data.name,\n        photo: data.photo,\n        gender: data.gender,\n      };\n    },\n    // 取得 personalWall 用戶資料\n    togglePersonalInfo(data) {\n      this.personalInfo = data;\n    },\n  },\n});\n","<template>\n  <div\n    class=\"modal fade\"\n    id=\"msgModal\"\n    tabindex=\"-1\"\n    aria-labelledby=\"msgModalLabel\"\n    data-bs-backdrop=\"static\"\n    data-bs-keyboard=\"false\"\n    aria-hidden=\"false\"\n  >\n    <div class=\"modal-dialog modal-dialog-centered\">\n      <div class=\"modal-content\">\n        <div class=\"modal-body pb-0 text-center\">\n          <slot></slot>\n        </div>\n        <div class=\"modal-footer justify-content-center\">\n          <button\n            type=\"button\"\n            class=\"btn btn-primary py-2 px-8\"\n            data-bs-dismiss=\"modal\"\n          >\n            確定\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"MsgModalComponent\",\n};\n</script>\n","import { render } from \"./MsgModalComponent.vue?vue&type=template&id=ffeb5a5e\"\nimport script from \"./MsgModalComponent.vue?vue&type=script&lang=js\"\nexport * from \"./MsgModalComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\user\\\\Desktop\\\\Node.js 直播班\\\\小組\\\\期末小組\\\\node_final\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n  <h1 class=\"header\">修改個人資料</h1>\r\n\r\n  <nav class=\"navTab\">\r\n    <div class=\"nav nav-tabs\" id=\"nav-tab\" role=\"tablist\">\r\n      <button\r\n        class=\"nav-link active\"\r\n        id=\"nav-profile-tab\"\r\n        data-bs-toggle=\"tab\"\r\n        data-bs-target=\"#nav-profile\"\r\n        type=\"button\"\r\n        role=\"tab\"\r\n        aria-controls=\"nav-profile\"\r\n        aria-selected=\"true\"\r\n        @click=\"toggleForm('profile')\"\r\n      >\r\n        修改資料\r\n      </button>\r\n      <button\r\n        class=\"nav-link\"\r\n        id=\"nav-password-tab\"\r\n        data-bs-toggle=\"tab\"\r\n        data-bs-target=\"#nav-password\"\r\n        type=\"button\"\r\n        role=\"tab\"\r\n        aria-controls=\"nav-password\"\r\n        aria-selected=\"false\"\r\n        @click=\"toggleForm('password')\"\r\n      >\r\n        重設密碼\r\n      </button>\r\n    </div>\r\n  </nav>\r\n  <div class=\"tab-content navTabContent\" id=\"nav-tabContent\">\r\n    <div\r\n      class=\"tab-pane fade show active px-4 py-8 px-md-8\"\r\n      id=\"nav-profile\"\r\n      role=\"tabpanel\"\r\n      aria-labelledby=\"nav-profile-tab\"\r\n    >\r\n      <VForm\r\n        v-slot=\"{ errors, meta }\"\r\n        id=\"profileForm\"\r\n        enctype=\"multipart/form-data\"\r\n        @submit=\"submitProfile\"\r\n        ref=\"profileForm\"\r\n      >\r\n        <div\r\n          class=\"bgCoverRounded mx-auto mb-4\"\r\n          :style=\"{ backgroundImage: 'url(' + tempImg.photo + ')' }\"\r\n          v-if=\"tempImg.photo\"\r\n        ></div>\r\n        <div\r\n          class=\"bgCoverRounded mx-auto mb-4\"\r\n          :style=\"{ backgroundImage: 'url(' + profile.photo + ')' }\"\r\n          v-else-if=\"profile.photo\"\r\n        ></div>\r\n        <div\r\n          class=\"bgCoverRounded mx-auto mb-4\"\r\n          :class=\"{ profileUserPhoto: !tempImg.photo }\"\r\n          v-else\r\n        ></div>\r\n        <div class=\"fileBtn text-center mb-4\">\r\n          <label for=\"photo\">上傳大頭照</label>\r\n          <input\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            id=\"photo\"\r\n            name=\"photo\"\r\n            @change=\"uploadFile\"\r\n          />\r\n          <small class=\"d-block mt-2 text-danger\">{{ tempImg.msg }}</small>\r\n        </div>\r\n        <div class=\"mb-4\">\r\n          <label for=\"nickname\" class=\"form-label\">暱稱</label>\r\n          <VField\r\n            type=\"text\"\r\n            id=\"name\"\r\n            placeholder=\"請輸入暱稱\"\r\n            name=\"name\"\r\n            class=\"form-control\"\r\n            :class=\"{ 'is-invalid': errors['name'] }\"\r\n            rules=\"nickanem:8\"\r\n            v-model=\"tempProfile.name\"\r\n            required\r\n          ></VField>\r\n          <error-message\r\n            name=\"name\"\r\n            class=\"invalid-feedback text-danger\"\r\n          ></error-message>\r\n        </div>\r\n        <div class=\"mb-8\">\r\n          <h3 class=\"mb-2 h5 fw-normal\">性別</h3>\r\n          <div class=\"form-check form-check-inline me-6\">\r\n            <VField\r\n              type=\"radio\"\r\n              id=\"male\"\r\n              name=\"gender\"\r\n              class=\"form-check-input\"\r\n              value=\"male\"\r\n              v-model=\"tempProfile.gender\"\r\n            ></VField>\r\n\r\n            <label class=\"form-check-label\" for=\"male\">男生</label>\r\n          </div>\r\n          <div class=\"form-check form-check-inline\">\r\n            <VField\r\n              type=\"radio\"\r\n              id=\"female\"\r\n              name=\"gender\"\r\n              class=\"form-check-input\"\r\n              value=\"female\"\r\n              v-model=\"tempProfile.gender\"\r\n            ></VField>\r\n            <label class=\"form-check-label\" for=\"female\">女生</label>\r\n          </div>\r\n        </div>\r\n        <small class=\"d-block mb-4 text-center text-danger\"></small>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          class=\"effectBtn btn btn-primary w-100\"\r\n          :disabled=\"!meta.valid\"\r\n        >\r\n          送出更新\r\n        </button>\r\n      </VForm>\r\n    </div>\r\n    <div\r\n      class=\"tab-pane fade px-4 py-8 px-md-8\"\r\n      id=\"nav-password\"\r\n      role=\"tabpanel\"\r\n      aria-labelledby=\"nav-password-tab\"\r\n    >\r\n      <VForm\r\n        v-slot=\"{ errors, meta }\"\r\n        @submit=\"submitPassword\"\r\n        ref=\"passwordForm\"\r\n      >\r\n        <div class=\"mb-4\">\r\n          <label for=\"password\" class=\"form-label\">密碼</label>\r\n          <VField\r\n            type=\"password\"\r\n            id=\"password\"\r\n            placeholder=\"請輸入密碼\"\r\n            name=\"密碼\"\r\n            class=\"form-control\"\r\n            :class=\"{ 'is-invalid': errors['密碼'] }\"\r\n            rules=\"required|password:8\"\r\n            v-model=\"tempPassword.password\"\r\n            required\r\n          ></VField>\r\n          <error-message\r\n            name=\"密碼\"\r\n            class=\"invalid-feedback text-danger\"\r\n          ></error-message>\r\n        </div>\r\n        <div class=\"mb-8\">\r\n          <label for=\"confirmed\" class=\"form-label\">確認密碼</label>\r\n          <VField\r\n            type=\"password\"\r\n            id=\"confirmed\"\r\n            placeholder=\"請再次輸入密碼\"\r\n            name=\"確認密碼\"\r\n            class=\"form-control\"\r\n            :class=\"{ 'is-invalid': errors['確認密碼'] }\"\r\n            rules=\"required|confirmed:@密碼\"\r\n            v-model=\"tempPassword.passwordConfirm\"\r\n            required\r\n          ></VField>\r\n          <error-message\r\n            name=\"確認密碼\"\r\n            class=\"invalid-feedback text-danger\"\r\n          ></error-message>\r\n        </div>\r\n        <button\r\n          type=\"submit\"\r\n          class=\"effectBtn btn btn-primary w-100\"\r\n          :disabled=\"!meta.valid\"\r\n        >\r\n          重設密碼\r\n        </button>\r\n      </VForm>\r\n    </div>\r\n  </div>\r\n\r\n  <MsgModalComponent>\r\n    <template #default>\r\n      <h3 class=\"mb-5\">{{ modal.title }}</h3>\r\n      <p class=\"text-gray-700\">{{ modal.content }}</p>\r\n    </template>\r\n  </MsgModalComponent>\r\n</template>\r\n\r\n<script>\r\nimport MsgModalComponent from \"@/components/MsgModalComponent.vue\";\r\nimport { mapState, mapActions } from \"pinia\";\r\nimport statusStore from \"@/stores/statusStore\";\r\nimport userStore from \"@/stores/userStore\";\r\nimport modalStore from \"@/stores/modalStore\";\r\n\r\nexport default {\r\n  name: \"ProfileView\",\r\n  data() {\r\n    return {\r\n      tempImg: {\r\n        photo: this.profile?.photo || \"\",\r\n        msg: \"\",\r\n      },\r\n      tempPassword: {\r\n        password: \"\",\r\n        passwordConfirm: \"\",\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    // 更新密碼\r\n    submitPassword() {\r\n      // 取得 password 的 form 表單\r\n      const form = this.$refs.passwordForm;\r\n      this.updatePassword(form, this.tempPassword);\r\n    },\r\n    // 瀏覽圖片\r\n    uploadFile(e) {\r\n      // 先清空圖片資料\r\n\r\n      this.tempImg = {\r\n        photo: this.profile?.photo || \"\",\r\n        msg: \"\",\r\n      };\r\n      // 取得上傳的檔案\r\n      const file = e.target.files[0];\r\n      // 篩選圖片格式及大小\r\n      if (file) {\r\n        const { size, type } = file;\r\n        if (!type.startsWith(\"image/\")) {\r\n          this.tempImg.msg = \"請確認圖片格式\";\r\n        } else if (size > 1048576) {\r\n          this.tempImg.msg = \"圖片檔案不能超過 1 MB\";\r\n        } else {\r\n          // 放入瀏覽圖\r\n          this.tempImg.photo = URL.createObjectURL(file);\r\n        }\r\n      }\r\n    },\r\n    // 切換表單\r\n    toggleForm(name) {\r\n      if (name == \"profile\") {\r\n        this.$refs.profileForm.resetForm();\r\n        this.tempImg = {\r\n          photo: this.profile?.photo || \"\",\r\n          msg: \"\",\r\n        };\r\n        this.getProfile();\r\n      } else {\r\n        this.$refs.passwordForm.resetForm();\r\n      }\r\n    },\r\n    // 更新個人資料\r\n    submitProfile() {\r\n      const formData = new FormData(document.getElementById(\"profileForm\"));\r\n      this.updateProfile(formData);\r\n    },\r\n    ...mapActions(statusStore, [\"pushMessage\", \"toggleLoading\"]),\r\n    ...mapActions(userStore, [\"getProfile\", \"updateProfile\", \"updatePassword\"]),\r\n    ...mapActions(modalStore, [\"toggleMsgModal\"]),\r\n  },\r\n  computed: {\r\n    ...mapState(userStore, [\"profile\", \"tempProfile\"]),\r\n    ...mapState(modalStore, [\"modal\"]),\r\n  },\r\n  components: {\r\n    MsgModalComponent,\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.profileUserPhoto {\r\n  background-image: url(\"@/assets/images/user_default.png\");\r\n}\r\n</style>\r\n","import { render } from \"./ProfileView.vue?vue&type=template&id=fbd5d4fe\"\nimport script from \"./ProfileView.vue?vue&type=script&lang=js\"\nexport * from \"./ProfileView.vue?vue&type=script&lang=js\"\n\nimport \"./ProfileView.vue?vue&type=style&index=0&id=fbd5d4fe&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\user\\\\Desktop\\\\Node.js 直播班\\\\小組\\\\期末小組\\\\node_final\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["status","statusStore","modal","modalStore","defineStore","state","profile","name","photo","gender","_id","tempProfile","personalInfo","actions","signIn","form","data","toggleLoading","apiUserSignIn","then","res","token","setToken","resetForm","router","catch","err","pushMessage","style","content","response","message","signUp","apiUserSignUp","async","isLoading","apiGetProfile","this","updateProfileData","clearToken","apiUpdateProfile","user","toggleMsgModal","title","apiUpdatePassword","apiForgetPassword","apiModifyPassword","togglePersonalInfo","class","id","tabindex","_createElementVNode","type","_createElementBlock","_renderSlot","_ctx","_hoisted_5","__exports__","render","role","for","_hoisted_1","onClick","$options","_createVNode","_component_VForm","enctype","onSubmit","ref","errors","meta","$data","backgroundImage","profileUserPhoto","_hoisted_7","accept","onChange","_toDisplayString","msg","_hoisted_10","_component_VField","placeholder","rules","$event","required","_component_error_message","_hoisted_12","value","_hoisted_14","_hoisted_16","_hoisted_17","disabled","valid","_hoisted_18","_hoisted_21","password","_hoisted_23","passwordConfirm","_hoisted_24","_component_MsgModalComponent","default","tempImg","tempPassword","methods","submitPassword","$refs","passwordForm","updatePassword","uploadFile","e","file","target","files","size","startsWith","URL","createObjectURL","toggleForm","profileForm","getProfile","submitProfile","formData","FormData","document","getElementById","updateProfile","mapActions","userStore","computed","mapState","components","MsgModalComponent"],"sourceRoot":""}