"use strict";(self["webpackChunknode_final"]=self["webpackChunknode_final"]||[]).push([[578],{7484:function(e,t,s){var a=s(1120),n=s(3766),o=s(3248),r=s(6294),l=s(2323);const c=(0,r.Z)(),i=(0,l.Z)();t["Z"]=(0,n.Q_)("postStore",{state:()=>({posts:[],pagination:{},currentPostId:""}),actions:{updateCurrentPostId(e){this.currentPostId=e},async getPosts(e){let t=e||{};t={pageCount:5,page:e?.page||1,sort:1,reverse:0==e?.reverse?0:1,content:e?.content},e?.userId?t.userId=e.userId:e?.postId&&(t.postId=e.postId),await(0,o.fN)(t).then((e=>{this.posts=e.data.data.data,this.pagination=e.data.data.pagination})).catch((e=>{c.pushMessage({style:"danger",content:e.response?.data?.message||"取得貼文失敗"})}))},async createPost(e){await(0,o.td)(e).then((()=>{c.pushMessage({style:"dark",content:"已建立貼文"}),a.Z.push("/")})).catch((e=>{c.pushMessage({style:"danger",content:e.response?.data?.message||"建立貼文失敗"})}))},async delPost(e){await(0,o.fj)(e).then((()=>{i.closeDelModal(),c.pushMessage({style:"dark",content:"刪除貼文成功"})})).catch((e=>{i.closeDelModal(),c.pushMessage({style:"danger",content:e.response?.data?.message||"刪除貼文失敗"})}))}}})},4578:function(e,t,s){s.r(t),s.d(t,{default:function(){return v}});var a=s(3396),n=s(9242),o=s(7139);const r=e=>((0,a.dD)("data-v-92656e68"),e=e(),(0,a.Cn)(),e),l=r((()=>(0,a._)("h1",{class:"header"},"張貼動態",-1))),c=r((()=>(0,a._)("div",{class:"mb-4"},[(0,a._)("label",{for:"content",class:"form-label"},"貼文內容"),(0,a._)("textarea",{name:"content",id:"content",class:"form-control",rows:"5",placeholder:"輸入您的貼文內容"})],-1))),i=r((()=>(0,a._)("label",{for:"img",class:"rounded-1"},"上傳圖片",-1))),m={class:"ms-4 text-danger"},d=r((()=>(0,a._)("i",{class:"bi bi-x-lg"},null,-1))),g=[d],p=r((()=>(0,a._)("div",{class:"text-center"},[(0,a._)("button",{type:"submit",class:"effectBtn btn btn-primary w-100"}," 送出貼文 ")],-1)));function u(e,t,s,r,d,u){return(0,a.wg)(),(0,a.iD)(a.HY,null,[l,(0,a._)("form",{id:"form",class:"card p-md-8",enctype:"multipart/form-data",onSubmit:t[2]||(t[2]=(0,n.iM)(((...e)=>u.submitPost&&u.submitPost(...e)),["prevent"]))},[c,(0,a._)("div",{class:(0,o.C_)(["fileBtn mb-4",{"mb-8":""==d.tempImg.url}])},[i,(0,a._)("input",{type:"file",accept:"image/*",id:"img",name:"img",onChange:t[0]||(t[0]=(...e)=>u.uploadFile&&u.uploadFile(...e))},null,32),(0,a._)("small",m,(0,o.zw)(d.tempImg.msg),1)],2),d.tempImg.url?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"bgCover position-relative mb-8",style:(0,o.j5)({backgroundImage:"url("+d.tempImg.url+")"})},[(0,a._)("a",{href:"#",class:"cardCloseBtn",onClick:t[1]||(t[1]=(0,n.iM)(((...e)=>u.resetImg&&u.resetImg(...e)),["prevent"]))},g)],4)):(0,a.kq)("",!0),p],32)],64)}var h=s(3766),f=s(7484),I={name:"CreatePostView",data(){return{tempImg:{url:"",msg:""}}},methods:{submitPost(){const e=new FormData(document.getElementById("form"));this.createPost(e)},uploadFile(e){this.resetImg();const t=e.target.files[0];if(t){const{size:e,type:s}=t;s.startsWith("image/")?e>1048576?this.tempImg.msg="圖片檔案不能超過 1 MB":this.tempImg.url=URL.createObjectURL(t):this.tempImg.msg="請確認圖片格式"}},resetImg(){this.tempImg={url:"",msg:""}},...(0,h.nv)(f.Z,["createPost"])}},b=s(89);const _=(0,b.Z)(I,[["render",u],["__scopeId","data-v-92656e68"]]);var v=_}}]);
//# sourceMappingURL=578.9b675482.js.map